# telemt-admin

**telemt-admin** ‚Äî —ç—Ç–æ Telegram-–±–æ—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ [telemt](https://github.com/telemt/telemt) (MTProto –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä–∞). –ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–º –Ω—É–∂–Ω–æ –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –≤—ã–¥–∞—á–∏ –¥–æ—Å—Ç—É–ø–∞, –∏–∑–±–∞–≤–∏–≤—à–∏—Å—å –æ—Ç —Ä—É—á–Ω–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤.

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç **—Å–∏—Å—Ç–µ–º—É –ø—Ä–∏–≥–ª–∞—Å–∏—Ç–µ–ª—å–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤** —Å –¥–≤—É–º—è —Ä–µ–∂–∏–º–∞–º–∏ —Ä–∞–±–æ—Ç—ã:

- **–†—É—á–Ω–æ–π (Manual):** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–¥–∞–µ—Ç –∑–∞—è–≤–∫—É, –∞–¥–º–∏–Ω –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç.
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π (Auto-approve):** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –ø–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç—É–ø –±–µ–∑ —É—á–∞—Å—Ç–∏—è –∞–¥–º–∏–Ω–∞.

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ?](#–∑–∞—á–µ–º-—ç—Ç–æ-–Ω—É–∂–Ω–æ)
- [–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è](#—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (Linux)](#–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç-linux)
- [–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–∞–∫ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∫–∞–∫-—Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ-—Å–µ—Ä–≤–∏—Å–∞)
- [–ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è](#–∫–∞–∫-–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è)
- [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (telemt-admin.toml)](#–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è-telemt-admintoml)
- [–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞](#–ø—Ä–æ–≤–µ—Ä–∫–∞-–ø–æ—Å–ª–µ-–∑–∞–ø—É—Å–∫–∞)
- [–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ](#–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ)
- [–°–±–æ—Ä–∫–∞ –∏–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤](#—Å–±–æ—Ä–∫–∞-–∏–∑-–∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤)
- [Troubleshooting](#troubleshooting)
- [CI/CD](#cicd)

## –ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ?

–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –≤ `telemt` —Ç—Ä–µ–±—É–µ—Ç –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–µ—Ä–≤–µ—Ä—É –∏ —Ä—É—á–Ω–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è `/etc/telemt.toml`.
**telemt-admin** –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç —ç—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å –≤ Telegram:

- **–î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:** –ø—Ä–æ—Å—Ç–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ –±–æ—Ç–∞ –ø–æ –ø—Ä–∏–≥–ª–∞—Å–∏—Ç–µ–ª—å–Ω–æ–º—É —Ç–æ–∫–µ–Ω—É.
- **–î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤:** –≥–∏–±–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º (–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã, –ª–∏–º–∏—Ç—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π), –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫–∏.
- **–î–ª—è —Å–µ—Ä–≤–µ—Ä–∞:** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Linux-—Å–µ—Ä–≤–µ—Ä —Å `systemd` (–¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è `telemt.service`).
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –∏ —Ä–∞–±–æ—Ç–∞—é—â–∏–π `telemt`.
- Telegram-–±–æ—Ç –∏ —Ç–æ–∫–µ–Ω –æ—Ç [@BotFather](https://t.me/BotFather).
- Telegram user ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ (–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —á–µ—Ä–µ–∑ `@userinfobot`).
- –ü—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å –≤ –∫–æ–Ω—Ñ–∏–≥ `telemt` –∏ –Ω–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞ `telemt` (—á–µ—Ä–µ–∑ Polkit –∏–ª–∏ sudo-–ø—Ä–∞–≤–∏–ª–∞).

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (Linux)

–°–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π —Å–ø–æ—Å–æ–± —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –±–æ—Ç–∞ ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–æ—Ç–æ–≤—ã–π –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª.

### 1. –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏

–û–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π —Å–∫–∞—á–∞–π—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å—Ç–∞–±–∏–ª—å–Ω—ã–π —Ä–µ–ª–∏–∑ –¥–ª—è Linux x86_64:

```bash
curl -L -o telemt-admin.tar.gz https://github.com/fgbm/telemt-admin/releases/latest/download/telemt-admin-linux-x86_64.tar.gz && tar -xzf telemt-admin.tar.gz
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª–∞

```bash
sudo mv telemt-admin /usr/local/bin/
sudo chmod +x /usr/local/bin/telemt-admin
```

### 3. –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `/etc/telemt-admin.toml`:

```toml
bot_token = "–í–ê–®_–¢–û–ö–ï–ù_–ë–û–¢–ê"
admin_ids = [123456789] # –í–∞—à Telegram ID
telemt_config_path = "/etc/telemt.toml"
db_path = "/var/lib/telemt-admin/state.db"
service_name = "telemt.service"

[security]
default_token_days = 14
max_token_days = 180
allow_auto_approve_tokens = true
```

> [!TIP]
> –ü–∞—Ä–∞–º–µ—Ç—Ä `bot_token` –º–æ–∂–Ω–æ –Ω–µ —É–∫–∞–∑—ã–≤–∞—Ç—å –≤ –∫–æ–Ω—Ñ–∏–≥–µ, –µ—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è `TELOXIDE_TOKEN` –∑–∞–¥–∞–Ω–∞ –≤ –æ–∫—Ä—É–∂–µ–Ω–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞.

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–∞–∫ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞

–î–ª—è –Ω–∞–¥–µ–∂–Ω–æ–π —Ä–∞–±–æ—Ç—ã –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ `systemd`:

### 1. –°–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏

```bash
sudo useradd --system --home /var/lib/telemt-admin --shell /usr/sbin/nologin telemt-admin
sudo mkdir -p /var/lib/telemt-admin
sudo chown -R telemt-admin:telemt-admin /var/lib/telemt-admin
```

### 2. –°–æ–∑–¥–∞–π—Ç–µ unit-—Ñ–∞–π–ª `/etc/systemd/system/telemt-admin.service`

```ini
[Unit]
Description=telemt-admin Telegram Bot Service
After=network-online.target

[Service]
Type=simple
User=telemt-admin
Group=telemt-admin
WorkingDirectory=/var/lib/telemt-admin
ExecStart=/usr/local/bin/telemt-admin /etc/telemt-admin.toml
Restart=always
RestartSec=5
Environment=RUST_LOG=info

[Install]
WantedBy=multi-user.target
```

### 3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

–ß—Ç–æ–±—ã —Å–µ—Ä–≤–∏—Å –º–æ–≥ —É–ø—Ä–∞–≤–ª—è—Ç—å `telemt` –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ –∫–æ–Ω—Ñ–∏–≥ –±–µ–∑ –ø—Ä–∞–≤ root:

#### –ê. –†–∞–∑—Ä–µ—à–∏—Ç–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞ —á–µ—Ä–µ–∑ Polkit

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `/etc/polkit-1/rules.d/50-telemt-admin.rules`:

```javascript
polkit.addRule(function(action, subject) {
    if (action.id == "org.freedesktop.systemd1.manage-units" &&
        action.lookup("unit") == "telemt.service" &&
        subject.user == "telemt-admin") {
        return polkit.Result.YES;
    }
});
```

#### –ë. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ –∫–æ–Ω—Ñ–∏–≥ telemt

```bash
# –°–æ–∑–¥–∞–µ–º –≥—Ä—É–ø–ø—É telemt –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç
sudo groupadd -f telemt

# –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±–æ—Ç–∞ –≤ –≥—Ä—É–ø–ø—É
sudo usermod -aG telemt telemt-admin

# –ú–µ–Ω—è–µ–º –≥—Ä—É–ø–ø—É –≤–ª–∞–¥–µ–ª—å—Ü–∞ –∫–æ–Ω—Ñ–∏–≥–∞ –∏ –¥–∞–µ–º –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å –≥—Ä—É–ø–ø–µ
sudo chown :telemt /etc/telemt.toml
sudo chmod 664 /etc/telemt.toml
```

### 4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å

```bash
sudo systemctl daemon-reload
sudo systemctl enable --now telemt-admin.service
```

## –ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

1. –ü–æ–ª—É—á–∏—Ç—å **–ø—Ä–∏–≥–ª–∞—Å–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω** –æ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.
2. –ù–∞–π—Ç–∏ –±–æ—Ç–∞ –∏ –Ω–∞–∂–∞—Ç—å `/start`.
3. –í–≤–µ—Å—Ç–∏ —Ç–æ–∫–µ–Ω (–∏–ª–∏ –ø–µ—Ä–µ–π—Ç–∏ –ø–æ —Å—Å—ã–ª–∫–µ –≤–∏–¥–∞ `https://t.me/MyBot?start=TOKEN`).
4. –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ —Ç–æ–∫–µ–Ω–∞:
    - **Auto:** –ë–æ—Ç —Å—Ä–∞–∑—É –ø—Ä–∏—à–ª–µ—Ç —Å—Å—ã–ª–∫—É –Ω–∞ –ø—Ä–æ–∫—Å–∏.
    - **Manual:** –ë–æ—Ç —Å–æ–∑–¥–∞—Å—Ç –∑–∞—è–≤–∫—É ("–û–∂–∏–¥–∞–π—Ç–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è"), –∏ –ø–æ—Å–ª–µ –æ–¥–æ–±—Ä–µ–Ω–∏—è –∞–¥–º–∏–Ω–æ–º –ø—Ä–∏—à–ª–µ—Ç —Å—Å—ã–ª–∫—É.

### –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤

#### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∞–º–∏

–ü—Ä–∏ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–π –∑–∞—è–≤–∫–∏ (–ø–æ Manual-—Ç–æ–∫–µ–Ω—É) –≤—ã –ø–æ–ª—É—á–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–∞–º–∏:

- **‚úÖ –û–¥–æ–±—Ä–∏—Ç—å**: –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–µ–∫—Ä–µ—Ç–∞, –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ–Ω—Ñ–∏–≥, —Ä–µ—Å—Ç–∞—Ä—Ç —Å–µ—Ä–≤–∏—Å–∞, –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å—Å—ã–ª–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.
- **‚ùå –û—Ç–∫–ª–æ–Ω–∏—Ç—å**: –∑–∞—è–≤–∫–∞ –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ.

#### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞–º–∏

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—ã `/token` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è–º–∏:

- `/token create [days] [--auto|-a] [--max-uses N]` ‚Äî —Å–æ–∑–¥–∞—Ç—å invite-—Ç–æ–∫–µ–Ω.
- `/token create [days]` ‚Äî —Å–æ–∑–¥–∞—Ç—å —Ç–æ–∫–µ–Ω —Å —Ä—É—á–Ω—ã–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `security.default_token_days`, –æ–±—ã—á–Ω–æ 14 –¥–Ω–µ–π).
- `/token create 30 --auto` ‚Äî —Å–æ–∑–¥–∞—Ç—å —Ç–æ–∫–µ–Ω –Ω–∞ 30 –¥–Ω–µ–π —Å **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –≤—Ö–æ–¥–æ–º**.
- `/token create 7 --max-uses 5` ‚Äî —Ç–æ–∫–µ–Ω –Ω–∞ 5 –∞–∫—Ç–∏–≤–∞—Ü–∏–π (–ø–æ–ª–µ–∑–Ω–æ –¥–ª—è –≥—Ä—É–ø–ø).
- `/token create --auto --max-uses 10 30` ‚Äî –∞—Ä–≥—É–º–µ–Ω—Ç—ã –º–æ–∂–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å –≤ –ª—é–±–æ–º –ø–æ—Ä—è–¥–∫–µ.
- –ü–æ—Å–ª–µ `/token create` –±–æ—Ç —Å—Ä–∞–∑—É –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≥–æ—Ç–æ–≤—É—é —Å—Å—ã–ª–∫—É –≤–∏–¥–∞ `https://t.me/MyBot?start=TOKEN` –≤ —Ñ–æ—Ä–º–∞—Ç–µ `` `...` `` –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.
- `/token list` ‚Äî —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤.
- `/token revoke <token>` ‚Äî –æ—Ç–æ–∑–≤–∞—Ç—å —Ç–æ–∫–µ–Ω (–∑–∞–ø—Ä–µ—Ç–∏—Ç—å –Ω–æ–≤—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏).

#### –ê–¥–º–∏–Ω-–º–µ–Ω—é

–ü–æ—Å–ª–µ `/start` –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –º–µ–Ω—é:

- `üì• –ù–æ–≤—ã–µ –∑–∞—è–≤–∫–∏` ‚Äî —Å–ø–∏—Å–æ–∫ pending-–∑–∞—è–≤–æ–∫.
- `üë• –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π` ‚Äî –∞–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (—É–¥–∞–ª–µ–Ω–∏–µ –ø–æ –∫–Ω–æ–ø–∫–µ).
- `‚öôÔ∏è –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞` ‚Äî –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è `telemt.service` (–æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å, —Ä–µ—Å—Ç–∞—Ä—Ç, –ø–µ—Ä–µ—á–∏—Ç–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥).
- `üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞` ‚Äî —Å–≤–æ–¥–∫–∞ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º.
- `‚ûï –°–æ–∑–¥–∞—Ç—å @username` ‚Äî –ø–æ–¥—Å–∫–∞–∑–∫–∞ –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤—Ä—É—á–Ω—É—é.
- `‚ùì –°–ø—Ä–∞–≤–∫–∞` ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.

**–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:**

- `/help` ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É –∏ –º–µ–Ω—é.
- `/approve <id>` / `/reject <id>` ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∞–º–∏.
- `/create <tg_user_id>` ‚Äî —Å–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤—Ä—É—á–Ω—É—é (–±–µ–∑ —Ç–æ–∫–µ–Ω–∞).
- `/delete <tg_user_id>` ‚Äî —É–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
- `/service <start|stop|restart|reload|status>` ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–º.

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (telemt-admin.toml)

| –ü–∞—Ä–∞–º–µ—Ç—Ä                    | –û–ø–∏—Å–∞–Ω–∏–µ                                                   |
| :-------------------------- | :--------------------------------------------------------- |
| `bot_token`                 | –¢–æ–∫–µ–Ω –±–æ—Ç–∞ –æ—Ç @BotFather (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –µ—Å–ª–∏ –µ—Å—Ç—å `TELOXIDE_TOKEN`). |
| `admin_ids`                 | –ú–∞—Å—Å–∏–≤ ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ `[123, 456]` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π).     |
| `telemt_config_path`        | –ü—É—Ç—å –∫ `/etc/telemt.toml` (default: `/etc/telemt.toml`).   |
| `db_path`                   | –ü—É—Ç—å –∫ `state.db` (default: `/var/lib/telemt-admin/state.db`). |
| `service_name`              | –ò–º—è —Å–µ—Ä–≤–∏—Å–∞ (default: `telemt.service`).                   |
| **[security]**              | **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Ç–æ–∫–µ–Ω–æ–≤**                         |
| `default_token_days`        | –°—Ä–æ–∫ –∂–∏–∑–Ω–∏ —Ç–æ–∫–µ–Ω–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (default: 14).              |
| `max_token_days`            | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –¥–æ–ø—É—Å—Ç–∏–º—ã–π —Å—Ä–æ–∫ (default: 180).                |
| `allow_auto_approve_tokens` | –†–∞–∑—Ä–µ—à–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ auto-approve —Ç–æ–∫–µ–Ω–æ–≤ (default: `true`). |

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å–µ—Ä–≤–∏—Å –∑–∞–ø—É—Å—Ç–∏–ª—Å—è –∏ –±–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç:

```bash
sudo systemctl status telemt-admin.service
sudo journalctl -u telemt-admin.service -n 50 --no-pager
```

–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π smoke-check:

1. –ù–∞–ø–∏—à–∏—Ç–µ –±–æ—Ç—É `/start` —Å –∞–∫–∫–∞—É–Ω—Ç–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∞–¥–º–∏–Ω-–º–µ–Ω—é.
3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ `/token create 1` –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º –∞–∫–∫–∞—É–Ω—Ç–æ–º.

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ

–î–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏ –ø—Ä–æ—Å—Ç–æ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É –∏–∑ —Ä–∞–∑–¥–µ–ª–∞ "–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç" –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å:

```bash
sudo systemctl restart telemt-admin.service
```

## –°–±–æ—Ä–∫–∞ –∏–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤

–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ —Å–æ–±—Ä–∞—Ç—å –±–æ—Ç–∞ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ:

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Rust (Edition 2024).
2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–±–æ—Ä–∫—É: `cargo build --release`.
3. –ë–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª –±—É–¥–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ `target/release/telemt-admin`.

–ó–∞–ø—É—Å–∫ —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º –∫–æ–Ω—Ñ–∏–≥–æ–º:

```bash
./target/release/telemt-admin /path/to/telemt-admin.toml
```

## Troubleshooting

- `–ù–µ –∑–∞–¥–∞–Ω bot_token...`  
  –£–∫–∞–∂–∏—Ç–µ `bot_token` –≤ –∫–æ–Ω—Ñ–∏–≥–µ –∏–ª–∏ –∑–∞–¥–∞–π—Ç–µ `TELOXIDE_TOKEN` –≤ –æ–∫—Ä—É–∂–µ–Ω–∏–∏ —Å–µ—Ä–≤–∏—Å–∞.

- `Permission denied` –ø—Ä–∏ –∑–∞–ø–∏—Å–∏ –≤ `/etc/telemt.toml`  
  –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≥—Ä—É–ø–ø—É/–ø—Ä–∞–≤–∞ —Ñ–∞–π–ª–∞ –∏ —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å `telemt-admin` –≤—Ö–æ–¥–∏—Ç –≤ –Ω—É–∂–Ω—É—é –≥—Ä—É–ø–ø—É.

- –ù–µ —É–¥–∞—ë—Ç—Å—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å `/service restart`  
  –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª–æ Polkit –¥–ª—è `org.freedesktop.systemd1.manage-units` –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å `service_name`.

- –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –∫–æ–º–∞–Ω–¥—ã  
  –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ `journalctl -u telemt-admin.service` –∏ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å —Ç–æ–∫–µ–Ω–∞ –±–æ—Ç–∞.

## CI/CD

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç GitHub Actions –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–¥–∞ (`clippy`, `check`) –∏ —Å–±–æ—Ä–∫–∏ —Ä–µ–ª–∏–∑–æ–≤ –ø–æ–¥ Linux –∏ Windows –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ç–µ–≥–∞ –≤–µ—Ä—Å–∏–∏ (`vX.Y.Z`).
